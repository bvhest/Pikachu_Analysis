<?xml version="1.0" encoding="UTF-8"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

	<map:components>
    
    <!-- setting xslt-saxon as default so we can leave it out on
    map:transform -->
		<map:transformers default="xslt-saxon">
		  <map:transformer name="xslt-saxon" 
        logger="sitemap.transformer.xalan"
		    pool-grow="2" pool-max="32" pool-min="8"
		    src="org.apache.cocoon.transformation.TraxTransformer">
		    <use-request-parameters>false</use-request-parameters>
		    <use-session-parameters>false</use-session-parameters>
		    <use-cookie-parameters>false</use-cookie-parameters>
		    <use-browser-capabilities-db>false</use-browser-capabilities-db>
		    <xslt-processor-role>org.apache.excalibur.xml.xslt.XSLTProcessor/saxon</xslt-processor-role>
		    <check-includes>true</check-includes>
		  </map:transformer>
        
      <map:transformer name="shell" src="org.apache.cocoon.transformation.FileActionsTransformer"/>
      
		</map:transformers>

		<!-- copy-source action is defined here, because I'm building against an external cocoon installation-->
    <map:actions>
      <map:action name="copy-source" src="org.apache.cocoon.acting.CopySourceAction"/>
    </map:actions>
	</map:components>

	<!-- -->
	<map:pipelines>
		<map:pipeline type="noncaching">

			<!-- -->
			<map:match pattern="*/**">
				<map:mount check-reload="yes" src="{1}/" uri-prefix="{1}"/>
			</map:match>

			<!-- -->
			<map:handle-errors>
				<map:select type="exception">
					<map:when test="not-found">
						<map:generate type="exception"/>
						<map:transform src="xsl/common/exception2html.xsl">
							<map:parameter name="contextPath" value="{request:contextPath}"/>
							<map:parameter name="realPath" value="{realpath:}"/>
							<map:parameter name="pageTitle" value="Resource not found"/>
						</map:transform>
						<map:serialize status-code="404"/>
					</map:when>
					<map:when test="invalid-continuation">
						<map:generate type="exception"/>
						<map:transform src="xsl/common/exception2html.xsl">
							<map:parameter name="contextPath" value="{request:contextPath}"/>
							<map:parameter name="realPath" value="{realpath:}"/>
							<map:parameter name="pageTitle" value="Invalid Continuation"/>
						</map:transform>
						<map:serialize status-code="404"/>
					</map:when>
					<map:otherwise>
						<map:generate type="exception"/>
						<map:transform src="xsl/common/exception2html.xsl">
							<map:parameter name="contextPath" value="{request:contextPath}"/>
							<map:parameter name="realPath" value="{realpath:}"/>
						</map:transform>
						<map:serialize status-code="500"/>
					</map:otherwise>
				</map:select>
			</map:handle-errors>
			<!-- -->
		</map:pipeline>
	</map:pipelines>
  <!-- -->
  <map:views>
    <map:view name="step1" from-label="step1">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="step2" from-label="step2">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="step3" from-label="step3">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="step4" from-label="step4">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="step5" from-label="step5">
      <map:serialize type="xml"/>
    </map:view>
    <map:view name="step6" from-label="step6">
      <map:serialize type="xml"/>
    </map:view>
  </map:views>
  <!-- -->
</map:sitemap>
