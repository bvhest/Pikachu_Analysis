<?xml version="1.0"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
  <!-- =========================== Components ================================ -->
  <map:components>
	</map:components>
  <!-- =========================== Resources =============================== -->
  <map:resources>
	</map:resources>
  <!-- =========================== Pipelines ================================= -->
  <map:pipelines>
    <!-- use case pipeline - URI request handling -->
    <map:pipeline>
      <!-- -->
      <map:match pattern="pikachu_product_nice.xml">
				<map:select type="resource-exists">
					<map:when test="../../{global:cmc2xslt}/PMT.xsl">
						<map:generate src="cocoon:/{global:gui_url}xmlraw/pikachu_product/{request-param:param1}/{request-param:param2}/{request-param:param3}.xml?id={request-param:id}" label="source"/>
						<!-- Transform to xUCDM format -->
            <map:transform type="xslt-saxon" src="../../../cmc2/xsl/common/icp-products.xsl" label="xucdm"/>
						<!-- Transform to create the preview -->
						<map:transform type="xslt-saxon" src="../../{global:cmc2xslt}/PMT.xsl"/>
					</map:when>
					<map:otherwise>
						<map:generate src="nopreview.xml"/>
					</map:otherwise>
				</map:select>
        <map:serialize type="xml"/>
      </map:match>
      <!-- -->
    </map:pipeline>
  </map:pipelines>
  <!-- -->
	<map:views>
		<map:view name="source" from-label="source">
			<map:serialize type="xml"/>
		</map:view>
		<map:view name="xucdm" from-label="xucdm">
			<map:serialize type="xml"/>
		</map:view>
	</map:views>
</map:sitemap>
