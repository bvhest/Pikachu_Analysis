<?xml version="1.0"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
  <!-- =========================== Components ================================ -->
  <map:components><!--map:transformer name="dump" logger="sitemap.transformer.dump" src="com.philips.cocoon.transformation.DumpTransformer"/--></map:components>
  <!-- =========================== Resources =============================== -->
  <map:resources/>
  <!-- =========================== Pipelines ================================= -->
  <map:pipelines>
    <map:pipeline>
      <!-- -->
      <map:match pattern="pals_scan.xml">
        <map:generate type="request" label="step1"/>
        <map:transform type="xslt-saxon" src="include.xslt" label="step2"/>
        <!--map:transform type="dump"><map:parameter name="logfile" value="{cmc2:gdir}/temp/temp/dump.pals.scan.include.xml"/></map:transform--> 
        <map:transform type="include" label="step3"/>
        <map:serialize type="xml"/>
      </map:match>
      <!-- -->
      <map:match pattern="palsscan">
        <map:generate type="xpathdirectory" src="{cmc2:gdir}/{request-param:ct}/{request-param:dir}">
          <map:parameter name="dateFormat" value="yyyy-MM-dd HH:mm"/>
          <map:parameter name="depth" value="1"/>
          <map:parameter name="sort" value="lastmodified"/>
          <map:parameter name="reverse" value="true"/>
          <map:parameter name="xpath" value="/Products/Product[starts-with(CTN,'{request-param:ctn}')]"/>
          <map:parameter name="include" value=".*\.{request-param:locale}\..*\.*"/>
          <map:parameter name="xmlFiles" value="\.xml$"/>
        </map:generate>          
        <map:transform type="xslt-saxon" src="show.xslt">
          <map:parameter name="id" value="{request-param:ctn}"/>
          <map:parameter name="ct" value="{request-param:ct}"/>
          <map:parameter name="locale" value="{request-param:locale}"/>
          <map:parameter name="directory" value="{request-param:direction}"/>
          <map:parameter name="dir" value="{request-param:dir}"/>
          <map:parameter name="gui_url" value="{global:gui_url}"/>
        </map:transform>
        <map:serialize type="xml"/>
      </map:match>
    </map:pipeline>
  </map:pipelines>
</map:sitemap>
